<!doctype html>
<html lang="en">

<head>
    <title>Explainable AI</title>
    <meta charset="utf-8">
    <meta name="description" content="Pretained Image Recognition Models.">
    <meta name="viewport" content="width=device-width">
    <link rel="apple-touch-icon-precomposed" href="media/favicon.png">
    <link rel="icon" href="media/favicon.png">
    <link rel="mask-icon" href="media/favicon.svg" color="rgb(36,38,58)">
    <link rel="shortcut icon" href="media/favicon.png">
    <link rel="stylesheet" href="css/main.css">
</head>

<body class="page page-style-guide preload">

    <header class="header-main dark">
        <nav>
            <a href="index.html" class="logo" rel="home"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24"><path d="M6.648 7.762c-.077-.11-.106-.245-.083-.376.024-.132.1-.248.21-.323l1.164-.8c1.536-1.076 3.406-1.486 5.25-1.16 3.82.673 6.373 4.32 5.704 8.113-.668 3.793-4.316 6.347-8.134 5.674-1.845-.326-3.462-1.35-4.485-2.813l-3.11-4.445c-.16-.23-.45-.33-.717-.245-.267.084-.45.33-.45.61C2 11.998 2 12 2 12c0 5.523 4.477 10 10 10s10-4.477 10-10S17.523 2 12 2C8.94 2 6.202 3.374 4.368 5.538c-.735.86-.794 2.11-.146 3.036 1.475 2.136 4.138 5.942 4.138 5.942.675.965 1.685 1.605 2.852 1.81 2.396.424 4.684-1.168 5.107-3.564.42-2.396-1.185-4.674-3.58-5.097-1.167-.205-2.335.05-3.36.77-.84.585-1.994.38-2.58-.458l-.152-.215z" fill="currentColor"/></svg><span>Riots Team</span></a>
            <div class="nav-toggle"></div>
            <ul class="inline">
                <li><a href="https://github.com/riotteams/tensorcam-" class="button button-primary button-m full-width-tablet" role="button">For GitHup Repositories</a></li>
            </ul>
        </nav>
    </header>

    <main>

        <section class="bg-image-03 center dark overlay padding">
            <div class="margin-bottom margin-top max-width-m">
                <h1>Welcome</h1>
                <p class="lead">Welcome to the TensorCAM documentation, a concise set of documentation that covers the basics of TensorCAM.</p>
            </div>
        </section>

        <div class="padding">
            <div class="row max-width-l">
                <div class="col-one-fifth">
                    <aside class="sidebar">
                        <h6 class="sidebar-header">Explainable AI Methods</h6>

                        <ul class="blank">

                            <li><a href="index.html#getting-started">Getting Started</a></li>
                            <li><a href="class-summaries.html#class-summaries">Class Summaries</a></li>
                            <li><a href="cam.html#cam">CAM</a></li>
                            <li><a href="grad-cam.html#grad-cam">GradCAM</a></li>
                            <li><a href="hires-cam.html#hirescam">HiResCAM</a></li>
                            <li><a href="grad-cam-element-wise.html#grad-cam-element-wise">GradCAMElementWise</a></li>
                            <li><a href="grad-cam-plusplus.html#grad-cam-plusplus">GradCAM++</a></li>
                            <li><a href="xgrad.html#xgrad-cam">XGradCAM</a></li>
                            <li><a href="score-cam.html#score-cam">ScoreCAM</a></li>
                            <li><a href="layer-cam.html#layer-cam">LayerCAM</a></li>
                            <li><a href="ablation-cam.html#ablation-cam">Ablation-CAM	</a></li>
                            <li><a href="fullgrad.html#fullgrad-cam">FullGrad-CAM	</a></li>
                            <li><a href="SmoothGradCAM.html#SmoothGradCAM">SmoothGradCAM</a></li>
                            <li><a href="smoothgradcampp.html#smoothgradcampp">smoothgradcampp </a></li>
                            <li><a href="SmoothHiresCAM.html#SmoothHiresCAM">SmoothHiresCAM	</a></li>
                            <li><a href="SmoothElementWise.html#SmoothElementWise">SmoothElementWise</a></li>
                        </ul>

                    </aside>
                </div>
                <div class="col-four-fifths">

                    <section id="score-cam" class="anchor">

                        <h4>ScoreCAM</h4>
                        <p class="paragraph">Score-CAM (Score-weighted Class Activation Mapping) is a technique used to generate Class Activation Maps (CAM) for a convolutional neural network (CNN). It is an improvement over the original CAM method, which only uses the feature
                            maps of the last convolutional layer to generate the heat map. <br> The main idea behind Score-CAM is to incorporate the output scores (predictions) of the CNN into the CAM generation process, in order to generate a more accurate
                            and informative heat map. <br> To generate the Score-CAM heat map, the method first forward-propagates the input image through the CNN to obtain the feature maps of all the layers and the output scores of the final classification
                            layer. Then, it multiplies the feature maps with the output scores element-wise, and sums up the resulting values across all feature maps of a layer. The resulting values are then used to generate the heat map. <br> Score-CAM
                            is particularly useful for understanding the decision-making process of a CNN because it allows us to see which regions of the image are important to the network's prediction, and how the output scores contribute to the final
                            prediction. It can be useful in scenarios like visualizing the decision of the model when it is not clear, and finding out the areas of the image which are crucial for the model to make a decision.
                            <br><strong>The localization map is computed as follows:</strong> </p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
              <msubsup>
                <mi>L</mi>
                <mrow data-mjx-texclass="ORD">
                  <mi>S</mi>
                  <mi>c</mi>
                  <mi>o</mi>
                  <mi>r</mi>
                  <mi>e</mi>
                  <mo>&#x2212;</mo>
                  <mi>C</mi>
                  <mi>A</mi>
                  <mi>M</mi>
                </mrow>
                <mrow data-mjx-texclass="ORD">
                  <mo stretchy="false">(</mo>
                  <mi>c</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
              </msubsup>
              <mo stretchy="false">(</mo>
              <mi>x</mi>
              <mo>,</mo>
              <mi>y</mi>
              <mo stretchy="false">)</mo>
              <mo>=</mo>
              <mi>R</mi>
              <mi>e</mi>
              <mi>L</mi>
              <mi>U</mi>
              <mrow data-mjx-texclass="ORD">
                <mo minsize="1.623em" maxsize="1.623em">(</mo>
              </mrow>
              <munder>
                <mo data-mjx-texclass="OP" movablelimits="false">&#x2211;</mo>
                <mi>k</mi>
              </munder>
              <msubsup>
                <mi>w</mi>
                <mi>k</mi>
                <mrow data-mjx-texclass="ORD">
                  <mo stretchy="false">(</mo>
                  <mi>c</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
              </msubsup>
              <msub>
                <mi>A</mi>
                <mi>k</mi>
              </msub>
              <mo stretchy="false">(</mo>
              <mi>x</mi>
              <mo>,</mo>
              <mi>y</mi>
              <mo stretchy="false">)</mo>
              <mrow data-mjx-texclass="ORD">
                <mo minsize="1.623em" maxsize="1.623em">)</mo>
              </mrow>
            </math>
                        <p>with the coefficient
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                <msubsup>
                  <mi>w</mi>
                  <mi>k</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mo stretchy="false">(</mo>
                    <mi>c</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msubsup>
              </math> being defined as:</p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
               <msubsup>
                 <mi>w</mi>
                 <mi>k</mi>
                 <mrow data-mjx-texclass="ORD">
                   <mo stretchy="false">(</mo>
                   <mi>c</mi>
                   <mo stretchy="false">)</mo>
                 </mrow>
               </msubsup>
               <mo>=</mo>
               <mi>s</mi>
               <mi>o</mi>
               <mi>f</mi>
               <mi>t</mi>
               <mi>m</mi>
               <mi>a</mi>
               <mi>x</mi>
               <mrow data-mjx-texclass="ORD">
                 <mo minsize="1.623em" maxsize="1.623em">(</mo>
               </mrow>
               <msup>
                 <mi>Y</mi>
                 <mrow data-mjx-texclass="ORD">
                   <mo stretchy="false">(</mo>
                   <mi>c</mi>
                   <mo stretchy="false">)</mo>
                 </mrow>
               </msup>
               <mo stretchy="false">(</mo>
               <msub>
                 <mi>M</mi>
                 <mi>k</mi>
               </msub>
               <mo stretchy="false">)</mo>
               <mo>&#x2212;</mo>
               <msup>
                 <mi>Y</mi>
                 <mrow data-mjx-texclass="ORD">
                   <mo stretchy="false">(</mo>
                   <mi>c</mi>
                   <mo stretchy="false">)</mo>
                 </mrow>
               </msup>
               <mo stretchy="false">(</mo>
               <msub>
                 <mi>X</mi>
                 <mi>b</mi>
               </msub>
               <mo stretchy="false">)</mo>
               <msub>
                 <mrow data-mjx-texclass="ORD">
                   <mo minsize="1.623em" maxsize="1.623em">)</mo>
                 </mrow>
                 <mi>k</mi>
               </msub>
             </math>
                        <p>where
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                 <msub>
                   <mi>A</mi>
                   <mi>k</mi>
                 </msub>
                 <mo stretchy="false">(</mo>
                 <mi>x</mi>
                 <mo>,</mo>
                 <mi>y</mi>
                 <mo stretchy="false">)</mo>
               </math> is the activation of node
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                  <mi>k</mi>
                </math> in the target layer of the model at position
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                   <mo stretchy="false">(</mo>
                   <mi>x</mi>
                   <mo>,</mo>
                   <mi>y</mi>
                   <mo stretchy="false">)</mo>
                 </math> ,
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                   <msup>
                     <mi>Y</mi>
                     <mrow data-mjx-texclass="ORD">
                       <mo stretchy="false">(</mo>
                       <mi>c</mi>
                       <mo stretchy="false">)</mo>
                     </mrow>
                   </msup>
                   <mo stretchy="false">(</mo>
                   <mi>X</mi>
                   <mo stretchy="false">)</mo>
                 </math> is the model output score for class
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                   <mi>c</mi>
                 </math> before softmax for input
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <mi>X</mi>
                  </math>,
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                  <msub>
                    <mi>X</mi>
                    <mi>b</mi>
                  </msub>
                </math> is a baseline image, and
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                     <msub>
                       <mi>M</mi>
                       <mi>k</mi>
                     </msub>
                   </math> is defined as follows:</p>
                        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                      <msub>
                        <mi>M</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>=</mo>
                      <mfrac>
                        <mrow>
                          <mi>U</mi>
                          <mo stretchy="false">(</mo>
                          <msub>
                            <mi>A</mi>
                            <mi>k</mi>
                          </msub>
                          <mo stretchy="false">)</mo>
                          <mo>&#x2212;</mo>
                          <munder>
                            <mo data-mjx-texclass="OP">min</mo>
                            <mi>m</mi>
                          </munder>
                          <mi>U</mi>
                          <mo stretchy="false">(</mo>
                          <msub>
                            <mi>A</mi>
                            <mi>m</mi>
                          </msub>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mrow>
                          <munder>
                            <mo data-mjx-texclass="OP">max</mo>
                            <mi>m</mi>
                          </munder>
                          <mi>U</mi>
                          <mo stretchy="false">(</mo>
                          <msub>
                            <mi>A</mi>
                            <mi>m</mi>
                          </msub>
                          <mo stretchy="false">)</mo>
                          <mo>&#x2212;</mo>
                          <munder>
                            <mo data-mjx-texclass="OP">min</mo>
                            <mi>m</mi>
                          </munder>
                          <mi>U</mi>
                          <mo stretchy="false">(</mo>
                          <msub>
                            <mi>A</mi>
                            <mi>m</mi>
                          </msub>
                          <mo stretchy="false">)</mo>
                        </mrow>
                      </mfrac>
                      <mo stretchy="false">)</mo>
                      <mo>&#x2299;</mo>
                      <msub>
                        <mi>X</mi>
                        <mi>b</mi>
                      </msub>
                    </math>
                        <h5>How do I use this technique on an image?</h5>
                        <h5>To load a ScoreCAM class:</h5>
                        <h4>This technique have Two parameters:</h4>
                        <ul>
                            <li><strong>model: </strong>This parameter refers to the convolutional neural network (CNN) that is being used to make predictions.</li>
                            <li><strong>target_layer: </strong>This parameter refers to the specific layer of the CNN that the gradients are computed with respect to.(Optional)</li>
                        </ul>
                        <div class="code-markup">
                            <span class="code-header"></span>
                            <code class="code-snippet">
                              from tensorcam.ScoreCAM import ScoreCAM  <br>
                              from tensorflow.keras.applications.resnet50 import ResNet50, decode_predictions <br>
                              model = ResNet50(include_top=True, weights='imagenet',input_shape=(224,224,3)) <br>
                              target_layer= 'conv5_block3_out'  <br>
               
              </code>
                        </div>
                        <h4> This technique have Two methods :</h4>
                        <p> <strong>get_image: </strong> function takes the origenal image and retern the image as a numpy 2d array and the origenal image self.<br> <strong>compute_cam_features: </strong> function takes an input image,and returns the CAM
                            heat map for that class.
                            <br><strong>plot_images: </strong>that takes the origenal image , the heatmap and return the image with the heatmap.</p>
                        <div class="code-markup">
                            <span class="code-header"></span>
                            <code class="code-snippet">
                              img,orig_img = ScoreCAM.get_image('sample.jpg')  <br>
                              score_cam=ScoreCAM(model,target_layer)  <br>
                              cam , top= score_cam.compute_cam_features(img)  <br>
                              print('Score activation prediction ' , top) <br>
                              score_cam.plot_images(orig_img,cam) <br>
              </code>
                        </div>

                        <img src="media/orig.png">
                        <img src="media/score/heatmap.png">
                        <img src="media/score/output.png">



                    </section>

    </main>

    <footer class="footer-main bg-light">

        <p class="copyright"><span>Made By </span><a href="https://uiuxassets.com/" target="_blank">Riots Team</a><span> - © 2022, all rights reserved.</span></p>
    </footer>

    <script src="js/main.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
</body>

</html>